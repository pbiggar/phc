Installation Instructions
=========================

System Requirements
-------------------

.. warning::
   These instructions only apply if you **don't** intend to modify phc, and you
   are using a downloaded |phc| release. If you intend to modify it, or you are
   using the |phc| <ulink url="http://code.google.com/p/phc">SVN
   repository</ulink>, please refer to the <link
   linkend="devintro">instructions for developers</link>.

|phc| needs a Unix-like environment to run (it has been tested on Linux,
Solaris, FreeBSD, Cygwin and Mac OS X).  To compile |phc|, you will need:

*  :program:`g++` *version 3.4.0* or higher
*  :program:`make`
*  :program:`Boost` *version 1.34* or higher
*  *PHP5 embed SAPI* (version 5.2.x recommended; refer to <xref
   linkend="phpbuild" endterm="phpbuild.title"> for more details). This is
   required to compile PHP code with |phc|.
*  <ulink url="http://xerces.apache.org/xerces-c/">Xerces-C++</ulink> if you
   want support for XML parsing (you don't need Xerces for XML unparsing).
*  *Boehm* garbage collector is used in |phc|, but not in code compiled by
   |phc|. If unavailable, it can be disabled with :option:`--disable-gc`, but |phc|
   will leak all memory it uses.


The following dependencies are optional:

*  a DOT viewer such as <ulink url="http://www.graphviz.org">graphviz</ulink>
   if you want to be able to view the graphical output generated by |phc| (for
   example, syntax trees)

Under Debian/Ubuntu, the following command will install nearly all
dependencies:

.. sourcecode:: bash

   apt-get install build-essential libboost-dev libxerces27-dev graphviz libgc-dev
   
You will still need to install the PHP embed SAPI manually.


PHP ``embed SAPI`` installation instructions
--------------------------------------------

If you do not intend to compile PHP code using |phc|, you may <link
linkend=install.instructions>skip</link> this section.

In order to compile code, |phc| must have the PHP embed SAPI available, which
is typically not available via standard package managers. The embed SAPI is
also required for compiling stand-alone executables.

Download the PHP source (.tar.gz) package from <ulink
url="http://www.php.net">php.net</ulink>. We will assume you downloaded PHP
version 5.2.10, the latest version available at time of writing. To extract
PHP,

.. sourcecode:: bash

   tar zxvf php-5.2.10.tar.gz


This will create a new directory :file:`php-5.2.10`. In order to configure and
compile PHP, you must know what configuration options you require. These are
likely to be the same as the version of PHP you are currently using, which can
be examined with the command

.. sourcecode:: bash

   php -i | grep Configure


We will assume these options are :option:`--enable-bcmath --with-gmp
--with-mysql`, a configuration which we occasionally use for benchmarking. You
are ready to build PHP. When configuring, you must add the :option:`--enable-embed`
option.

.. sourcecode:: bash

   CFLAGS="-O3" ./configure --enable-bcmath --with-gmp --with-mysql --enable-embed
   make


If this command does not succeed, there is a problem with PHP on your system,
and you should <ulink url="http://bugs.php.net">file a bug report with the PHP
group</ulink>. (There is a known bug, and long work-around for OSX already
filed in the PHP bug system).

.. todo:

   link to it

The most important part of the command is :option:`--enable-embed`.
While the :option:`CFLAGS="-O3"` environmental variable is optional, we
find it speeds up the executable by about four times. If PHP is already
installed on your system, you may want to install this version separately,
using the :option:`--prefix` option. Other configuration options are discussed
in the <link linkend=dev.phpbuild>developer manual</link>.  Finally, install
the embed SAPI:

.. sourcecode:: bash

   make install


	
Installation Instructions
-------------------------

First of all, you must <ulink
url="http://www.phpcompiler.org/downloads.html">download</ulink> the latest
release of |phc|. To extract |phc|,

.. sourcecode:: bash

   tar zxvf phc-0.2.0.tar.gz

	
This will create a new directory ``phc-0.2.0`` that contains the
|phc| source tree. Finally, you must compile |phc|. If the dependencies are
in their standard locations, you should be able to simply type

.. sourcecode:: bash

   cd phc-0.2.0
   ./configure
   make


(Consult :program:`./configure --help` for configuration options, if your
dependencies are not in standard locations). This should compile without any
warnings or errors. If this step fails, please send a bug report to the <ulink
url="http://www.phpcompiler.org/mailinglist.html">mailing list</ulink> with as
much information about your system as you can give, and we will try to resolve
it. Finally, install |phc| using

.. sourcecode:: bash

   make install


For information on running |phc|, see <xref linkend="runningphc"
endterm="runningphc.title">.  If you can follow those instructions and you get
the output you should get, congratulations!  You have successfully installed
|phc|.
